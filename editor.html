<!DOCTYPE html>
<html>
    <head>
        <title>编辑书源</title>
        <!--Import Google Icon Font-->
        <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
        <!--Import materialize.css-->
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
        <!-- <link href="https://cdn.bootcss.com/material-kit/2.0.4/css/material-kit.min.css" rel="stylesheet"> -->
        <!--Let browser know website is optimized for mobile-->
        <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    </head>

    <body>

        <header>
        	<nav class="top-nav">
        	<div class="nav-wrapper">
        		<a href="index.html" class="brand-logo"><i class="material-icons">view_headline</i>书源编辑器</a>
        		<ul id="nav-mobile" class="right hide-on-med-and-down">
        			<li><a href="/2019/05/31/SourceRule">书源规则</a></li>
        		</ul>
        	</div>
            </nav>
        </header>

        <main>
        <div class="container">
        <div class="row">
            <form id="editor" class="col s12">
                <h5>书源信息</h5>
                <div class="row">
                    <div class="input-field col s6">
                        <input id="rootLonk" name="rootLonk" type="text" class="validate" value="">
                        <label for="rootLonk">书源地址</label>
                    </div>
                    <div class="input-field col s6">
                        <input id="sourceName" name="sourceName" type="text" class="validate" value="">
                        <label for="sourceName">书源名称</label>
                    </div>
                </div>
                <div class="row">
                    <div class="input-field col s6">
                        <input id="sourceType" name="sourceType" type="text" class="validate" value="">
                        <label for="sourceType">书源类型</label>
                    </div>
                    <div class="input-field col s6">
                        <input id="encodeType" name="encodeType" type="text" class="validate" value="">
                        <label for="encodeType">编码格式</label>
                    </div>
                </div>
                <div class="row">
                    <div class="input-field col s6">
                        <input id="searchLink" name="searchLink" type="text" class="validate" value="">
                        <label for="searchLink">搜索地址</label>
                    </div>
                </div>
                <h5>搜索规则</h5>
                <div class="row">
                    <div class="input-field col s6">
                        <input id="ruleSearchBooks" name="ruleSearchBooks" type="text" class="validate" value="">
                        <label for="ruleSearchBooks">搜索结果列表规则</label>
                    </div>
                    <div class="input-field col s6">
                        <input id="ruleSearchTitle" name="ruleSearchTitle" type="text" class="validate" value="">
                        <label for="ruleSearchTitle">搜索结果名称规则</label>
                    </div>
                </div>
                <div class="row">
                    <div class="input-field col s6">
                        <input id="ruleSearchAuthor" name="ruleSearchAuthor" type="text" class="validate" value="">
                        <label for="ruleSearchAuthor">搜索结果作者规则</label>
                    </div>
                    <div class="input-field col s6">
                        <input id="ruleSearchDesc" name="ruleSearchDesc" type="text" class="validate" value="">
                        <label for="ruleSearchDesc">搜索结果简介规则</label>
                    </div>
                </div>
                <div class="row">
                    <div class="input-field col s6">
                        <input id="ruleSearchCover" name="ruleSearchCover" type="text" class="validate" value="">
                        <label for="ruleSearchCover">搜索结果封面规则</label>
                    </div>
                    <div class="input-field col s6">
                        <input id="ruleSearchLink" name="ruleSearchLink" type="text" class="validate" value="">
                        <label for="ruleSearchLink">搜索结果链接规则</label>
                    </div>
                </div>
                <h5>详情规则</h5>
                <div class="row">
                    <div class="input-field col s6">
                        <input id="ruleDetailBook" name="ruleDetailBook" type="text" class="validate" value="">
                        <label for="ruleDetailBook">书籍详情结果规则</label>
                    </div>
                </div>
                <div class="row">
                	 <div class="input-field col s6">
                        <input id="ruleDetailTitle" name="ruleDetailTitle" type="text" class="validate" value="">
                        <label for="ruleDetailTitle">书籍详情名称规则</label>
                    </div>
                    <div class="input-field col s6">
                        <input id="ruleDetailAuthor" name="ruleDetailAuthor" type="text" class="validate" value="">
                        <label for="ruleDetailAuthor">书籍详情作者规则</label>
                    </div>
                </div>
                <div class="row">
                    <div class="input-field col s6">
                        <input id="ruleDetailDesc" name="ruleDetailDesc" type="text" class="validate" value="">
                        <label for="ruleDetailDesc">书籍详情介绍规则</label>
                    </div>
                    <div class="input-field col s6">
                        <input id="ruleDetailCover" name="ruleDetailCover" type="text" class="validate" value="">
                        <label for="ruleDetailCover">书籍详情封面规则</label>
                    </div>
                </div>
                <div class="row">
                    <div class="input-field col s6">
                        <input id="ruleCatalogLink" name="ruleCatalogLink" type="text" class="validate" value="">
                        <label for="ruleCatalogLink">书籍章节地址规则</label>
                    </div>
                    <div class="input-field col s6">
                        <input id="ruleFindLink" name="ruleFindLink" type="text" class="validate" value="">
                        <label for="ruleFindLink">书籍发现规则</label>
                    </div>
                </div>
                <h5>目录规则</h5>
                <div class="row">
                    <div class="input-field col s6">
                        <input id="ruleChapters" name="ruleChapters" type="text" class="validate" value="">
                        <label for="ruleChapters">目录章节列表规则</label>
                    </div>
                </div>
                <div class="row">
                	 <div class="input-field col s6">
                        <input id="ruleDetailTitle" name="ruleDetailTitle" type="text" class="validate" value="">
                        <label for="ruleDetailTitle">目录章节名称规则</label>
                    </div>
                    <div class="input-field col s6">
                        <input id="ruleDetailAuthor" name="ruleDetailAuthor" type="text" class="validate" value="">
                        <label for="ruleDetailAuthor">目录章节地址规则</label>
                    </div>
                </div>
                <h5>章节规则</h5>
                <div class="row">
                    <div class="input-field col s6">
                        <input id="ruleChapters" name="ruleChapters" type="text" class="validate" value="">
                        <label for="ruleChapters">章节内容规则</label>
                    </div>
                </div>
                <h5>发现规则</h5>
                <div class="row">
                    <div class="input-field col s6">
                        <input id="ruleFindBooks" name="ruleFindBooks" type="text" class="validate" value="">
                        <label for="ruleFindBooks">发现书籍列表规则</label>
                    </div>
                    <div class="input-field col s6">
                        <input id="ruleFindCover" name="ruleFindCover" type="text" class="validate" value="">
                        <label for="ruleFindCover">发现书籍封面规则</label>
                    </div>
                </div>
                <div class="row">
                	<div class="input-field col s6">
                        <input id="ruleFindBookTitle" name="ruleFindBookTitle" type="text" class="validate" value="">
                        <label for="ruleFindBookTitle">发现书籍名称规则</label>
                    </div>
                    <div class="input-field col s6">
                        <input id="ruleFindBookLink" name="ruleFindBookLink" type="text" class="validate" value="">
                        <label for="ruleFindBookLink">发现书籍链接规则</label>
                    </div>
                </div>
            </form>
        </div>
        </div>
        </main>

        <div id="submit" data-target="modal" class="fixed-action-btn" style="bottom: 45px; right: 24px;">
          <a class="btn-floating btn-large red">
            <i class="material-icons">add</i>
          </a>
        </div>

        <footer class="page-footer">
          <div class="footer-copyright">
            <div class="container">
            本网站只提供web页面服务，并不提供书源存储。若本站无意侵犯了贵司版权，请及时与我们联系，谢谢！
            <a class="grey-text text-lighten-4 right" href="#!">© 2019 NewBook, All Rights Reserved.</a>
            </div>
          </div>
        </footer>

        <!-- Modal Structure-->
        <div id="modal" class="modal">
        	<div class="modal-content center-align">
        		<h4>请扫描二维码</h4>
        		<div id="qrcode"></div>
        	</div>
        	<div class="modal-footer">
        		<a id="copy" href="#!" class="modal-close waves-effect waves-green btn-flat">复制Json字符串</a>
        	</div>
        </div>

        <!--JavaScript at end of body for optimized loading-->
        <script type="text/javascript" src="http://code.jquery.com/jquery-3.4.1.min.js"></script>
        <!-- Compiled and minified JavaScript -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
        <!-- <script src="https://cdn.bootcss.com/material-kit/2.0.4/js/material-kit.min.js"></script> -->
        <script src="https://cdn.bootcss.com/jquery.qrcode/1.0/jquery.qrcode.min.js"></script>
        <script src="https://cdn.bootcss.com/clipboard.js/2.0.4/clipboard.min.js"></script>
    </body>
</html>
        
<script type="text/javascript">
	$(document).ready(function(){
	 	$('.modal').modal();
	});

	$("#copy").click(function(){
        //将json数组转为json 对象
        var formData = $("#editor").serializeArray();
        var jsons = transformToJson(formData);
        $("#copy").attr("data-clipboard-text",JSON.stringify(jsons));
        var btn = document.getElementById('copy');
        var clipboard = new ClipboardJS(btn);
        clipboard.on('success', function(e) {
        	console.log(e);
        });
        clipboard.on('error', function(e) {
        	console.log(e);
        });
    });

    $("#submit").click(function(){
        //将json数组转为json 对象
        var formData = $("#editor").serializeArray();
        var jsons = transformToJson(formData);
        $('#modal').modal('open');
        $("#qrcode").html("");
        $("#qrcode").qrcode({
            width:200,
            height:200,
            text:JSON.stringify(jsons)
        })
    });

    // 转为json数据格式
    function transformToJson(formData){
        console.log(formData);
        var obj={}
        for (var i in formData) {
            //下标为的i的name做为json对象的key，下标为的i的value做为json对象的value
            obj[formData[i].name]=formData[i]['value'];
        }
        return obj;
    }
</script>